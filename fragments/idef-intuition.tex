%olli22*: rewriting this
% To build some intuition for $\SDef$, we now go through some examples, illustrated in \cref{fig:sdef-example-panel}.
% To build intuition for $\SDef$, which characterizes our bounds in \cref{sec:info},
% 	we now visualize the vector $\mat v_{\!\Ar}$ for various example hypergraphs. 

% \begin{example}
    %[visualizing the information profile]
\relax%
	\definecolor{subfiglabelcolor}{RGB}{0,0,0}
	\begin{figure}
		\centering
	\def\vsize{0.4}
	\def\spacerlength{0.5em}
	% \scalebox{0.85}{
	%apparently  I have to manually step the figure number to make subfigures number properly.
	\stepcounter{figure}
	% \makebox[\textwidth][c]{
		\refstepcounter{subfigure}
		\begin{tikzpicture}\label{subfig:justX-0}
			\node[dpad0] (X) at (0,1){$X$};
			\draw[fill=green!50!black]  (0,0) circle (\vsize)  ++(-90:.22) node[label=below:\tiny$X$]{};
	%		\useasboundingbox (current bounding box);
			\node at (-0.5, 0.6){\slshape\color{subfiglabelcolor}(\thesubfigure)};
		\end{tikzpicture}\!
		% \\
	\begin{tabular}{c}
		\refstepcounter{subfigure}\label{subfig:justX-1}
		\begin{tikzpicture}[is bn]
			\node[] (1) at (-0.4, 1){};
			\node[dpad0] (X) at (0.4, 1){$X$};
			\draw[arr1] (1)  -- (X);
			\draw[fill=white!70!black]  (0,0) circle (\vsize) ++(-90:.22) node[label=below:\tiny$X$]{};
			\node at (-0.6,0.35){};
	%		\useasboundingbox (current bounding box);
			\node at (-0.7, 0.35){\slshape\color{subfiglabelcolor}(\thesubfigure)};
		\end{tikzpicture}
		\\
		\refstepcounter{subfigure}\label{subfig:justX-2}
		\begin{tikzpicture}
			\node[] (1) at  (-0.45,.85){};
			\node[dpad0] (X) at  (0.45,.85){$X$};
			\draw[arr1] (1) to[bend left=20] (X);
			\draw[arr1] (1) to[bend right=20] (X);
			\draw[fill=red!50!black] (0,0) circle (\vsize) ++(-90:.22) node[label=below:\tiny$X$]{};
	%		\useasboundingbox (current bounding box);
			\node at (-0.7, 0.35){\slshape\color{subfiglabelcolor}(\thesubfigure)};
		\end{tikzpicture}
	\end{tabular}%}
	\hspace{\spacerlength}\vrule\hspace{\spacerlength}
    % \\\smallskip\hrule\smallskip
		%% EXAMPLE: X  Y
		% \adjustbox{valign=b}{
		\begin{tabular}{c}
		\refstepcounter{subfigure}\label{subfig:justXY}
		\begin{tikzpicture}[]
			% \node[dpad0] (1) at (0,2){$ 1$};
			\node[dpad0] (X) at (-0.45,.85){$X$};
			\node[dpad0] (Y) at (0.45,.85){$Y$};
			% \draw[arr] (1) to[] (X);
			% \draw[arr] (1) to[] (Y);
			\path[fill=green!50!black] (-0.2,0) circle (\vsize) ++(-110:.23) node[label=below:\tiny$X$]{};
			\path[fill=green!50!black] (0.2,0) circle (\vsize) ++(-70:.23) node[label=below:\tiny$Y$]{};
			\begin{scope}
				\clip (-0.2,0) circle (\vsize);
				\clip (0.2,0) circle (\vsize);
				\fill[green!50!black] (-1,-1) rectangle (3,3);
				% \draw[ultra thick,white] (-0.2,0) circle (\vsize);
				% \draw[ultra thick,white] (0.2,0) circle (\vsize);
			\end{scope}
			\draw (-0.2,0) circle (\vsize);
			\draw (0.2,0) circle (\vsize);
	%		\useasboundingbox (current bounding box);
			\node at (-0.8, 0.4){\slshape\color{subfiglabelcolor}(\thesubfigure)};
		\end{tikzpicture}\\[0.5em]
		%% EXAMPLE: X -> Y
		\refstepcounter{subfigure}\label{subfig:XtoY}
		\begin{tikzpicture}[]
			% \node[dpad0] (1) at (0,2){$ 1$};
			\node[dpad0] (X) at (-0.45,0.85){$X$};
			\node[dpad0] (Y) at (0.45,0.85){$Y$};
			\draw[arr1] (X) to[] (Y);
			% \draw[arr] (1) to[] (Y);
			\path[fill=green!50!black] (-0.2,0) circle (\vsize) ++(-110:.23) node[label=below:\tiny$X$]{};
			\path[fill=white!70!black] (0.2,0) circle (\vsize) ++(-70:.23) node[label=below:\tiny$Y$]{};
			\begin{scope}
				\clip (-0.2,0) circle (\vsize);
				\clip (0.2,0) circle (\vsize);
				\fill[green!50!black] (-1,-1) rectangle (3,3);
				% \draw[ultra thick,white] (-0.2,0) circle (\vsize);
				% \draw[ultra thick,white] (0.2,0) circle (\vsize);
			\end{scope}
			\draw (-0.2,0) circle (\vsize);
			\draw (0.2,0) circle (\vsize);
	%		\useasboundingbox (current bounding box);
			\node at (-0.8, 0.4){\slshape\color{subfiglabelcolor}(\thesubfigure)};
		\end{tikzpicture}
	\end{tabular}%}
	% \hspace{\spacerlength}
	\begin{tabular}{c}
		%% EXAMPLE: X <-> Y
		\refstepcounter{subfigure}\label{subfig:XY-cycle}
		\begin{tikzpicture}[center base]
			% \node[dpad0] (1) at (0,2){$ 1$};
			\node[dpad0] (X) at (-0.49,0.85){$X$};
			\node[dpad0] (Y) at (0.49,0.85){$Y$};
			\draw[arr1] (X) to[bend left] (Y);
			\draw[arr1] (Y) to[bend left] (X);
			\draw[fill=white!70!black] (-0.2,0) circle (\vsize) ++(-110:.25) node[label=below:\tiny$X$]{};
			\draw[fill=white!70!black] (0.2,0) circle (\vsize) ++(-70:.25) node[label=below:\tiny$Y$]{};
			\begin{scope}
				\clip (-0.2,0) circle (\vsize);
				\clip (0.2,0) circle (\vsize);
				\fill[green!50!black] (-1,-1) rectangle (3,3);
				% \draw[ultra thick,white] (-0.2,0) circle (\vsize);
				% \draw[ultra thick,white] (0.2,0) circle (\vsize);
			\end{scope}
			\draw (-0.2,0) circle (\vsize);
			\draw (0.2,0) circle (\vsize);
	%		\useasboundingbox (current bounding box.south west) rectangle (current bounding box.north east);
			\node at (-0.85, 0.4){\slshape\color{subfiglabelcolor}(\thesubfigure)};
		\end{tikzpicture}\\[2.5em]
	% \hspace{\spacerlength}%% EXAMPLE: 1 -> Y;1->X
	\refstepcounter{subfigure}\label{subfig:XYindep}
		\begin{tikzpicture}[center base, is bn]
			% \node[] (1) at (0,0.75){};
			% \node[dpad0] (X) at (-0.6,1.05){$X$};
			% \node[dpad0] (Y) at (0.6,0.85){$Y$};
			\node[dpad0] (X) at (-0.4,0.95){$X$};
			\node[dpad0] (Y) at (0.4,0.95){$Y$};
			% \draw[arr0] (1) to[] (X);
			% \draw[arr0] (1) to[] (Y);
            % \draw[arr1,<-] (X) -- +(1,0.2);
            % \draw[arr1,<-] (Y) -- +(-1,-0.2);
            \draw[arr1,<-] (X) -- +(-0.7,0.2);
            \draw[arr1,<-] (Y) -- +(0.7,0.2);
			\draw[fill=white!70!black] (-0.2,0) circle (\vsize) ++(-110:.23) node[label=below:\tiny$X$]{};
			\draw[fill=white!70!black] (0.2,0) circle (\vsize) ++(-70:.23) node[label=below:\tiny$Y$]{};
			\begin{scope}
				\clip (-0.2,0) circle (\vsize);
				\clip (0.2,0) circle (\vsize);
				\fill[red!50!black] (-1,-1) rectangle (3,3);
				% \draw[ultra thick,white] (-0.2,0) circle (\vsize);
			% \draw[ultra thick,white] (0.2,0) circle (\vsize);
			\end{scope}
			\draw (-0.2,0) circle (\vsize);
			\draw (0.2,0) circle (\vsize);
	%		\useasboundingbox (current bounding box.south west) rectangle (current bounding box.north east);
			\node at (-0.88, 0.4){\slshape\color{subfiglabelcolor}(\thesubfigure)};
		\end{tikzpicture}
	\end{tabular}
	\hspace{\spacerlength}
		 %% EXAMPLE: 1 -> X -> Y
		 \refstepcounter{subfigure}\label{subfig:1XY}
		\begin{tikzpicture}[center base, is bn]
			\node[] (1) at (0.15,2){};
			\node[dpad0] (X) at (-0.5,1.4){$X$};
			\node[dpad0] (Y) at (0.4,1){$Y$};
			\draw[arr0] (1) to[] (X);
			\draw[arr1] (X) to[] (Y);
			\path[fill=white!70!black] (-0.2,0) circle (\vsize) ++(-110:.23) node[label=below:\tiny$X$]{};
			\path[fill=white!70!black] (0.2,0) circle (\vsize) ++(-70:.23) node[label=below:\tiny$Y$]{};
			\begin{scope}
				\clip (-0.2,0) circle (\vsize);
				\clip (0.2,0) circle (\vsize);
				% \fill[red!50!black] (-1,-1) rectangle (3,3);
				% \draw[ultra thick,white] (-0.2,0) circle (\vsize);
				% \draw[ultra thick,white] (0.2,0) circle (\vsize);					\end{scope}
			\end{scope}
			\draw (-0.2,0) circle (\vsize);
			\draw (0.2,0) circle (\vsize);
	%		\useasboundingbox (current bounding box);
			\node at (-0.7, 0.6){\slshape\color{subfiglabelcolor}(\thesubfigure)};
		\end{tikzpicture}
	% \hspace{\spacerlength}\hspace{2.5pt}\vrule\hspace{2.5pt}\hspace{\spacerlength}
    \\\smallskip\hrule\smallskip
		%% EXAMPLE: 1 -> X -> Y -> Z
		 \refstepcounter{subfigure}\label{subfig:1XYZ}
		\begin{tikzpicture}[center base,is bn]
			\node[] (1) at (-0.6,2.3){};
			\node[dpad0] (X) at (-0.5,1.5){$X$};
			\node[dpad0] (Y) at (0.25,2.25){$Y$};
			\node[dpad0] (Z) at (0.35,1.25){$Z$};
			\draw[arr1] (1) to (X);
			\draw[arr0] (X) to[] (Y);
			\draw[arr2] (Y) to[] (Z);
			\path[fill=white!70!black] (210:0.22) circle (\vsize) ++(-130:.25) node[label=below:\tiny$X$]{};
			\path[fill=white!70!black] (-30:0.22) circle (\vsize) ++(-50:.25) node[label=below:\tiny$Z$]{};
			\path[fill=white!70!black] (90:0.22) circle (\vsize) ++(40:.29) node[label=above:\tiny$Y$]{};
			\begin{scope}
                \clip (-30:0.22) circle (\vsize);
				\clip (210:0.22) circle (\vsize);
				\fill[red!50!black] (-1,-1) rectangle (3,3);
				% \draw[ultra thick,white] (210:0.2) circle (\vsize);
				% \draw[ultra thick,white] (90:0.2) circle (\vsize);
                \clip (90:0.22) circle (\vsize);
				\fill[white!70!black] (-1,-1) rectangle (3,3);
				% \draw[ultra thick,white] (-30:0.2) circle (\vsize);
				% \draw[ultra thick,white] (210:0.2) circle (\vsize);
				% \draw[ultra thick,white] (90:0.2) circle (\vsize);
			\end{scope}
			\begin{scope}
				\draw[] (-30:0.22) circle (\vsize);
				\draw[] (210:0.22) circle (\vsize);
				\draw[] (90:0.22) circle (\vsize);
			\end{scope}
	%		\useasboundingbox (current bounding box);
			\node at (-0.7, 0.7){\slshape\color{subfiglabelcolor}(\thesubfigure)};
		\end{tikzpicture}
		\hspace{3pt}
	\hspace{\spacerlength}%\vrule\hspace{\spacerlength}
		%% EXAMPLE: X -> Y -> Z -> X
		\refstepcounter{subfigure}\label{subfig:XYZ-cycle}
		\begin{tikzpicture}[center base]
			% \node[dpad0] (1) at (-0.5,2.3){$1$};
			\node[dpad0] (X) at (-0.5,1.75){$X$};
			\node[dpad0] (Y) at (0.25,2.25){$Y$};
			\node[dpad0] (Z) at (0.35,1.25){$Z$};
			% \draw[arr0] (1) to (X);
			\draw[arr1] (X) to[bend left=25] (Y);
			\draw[arr1] (Y) to[bend left=25] (Z);
			\draw[arr1] (Z) to[bend left=25] (X);
			%option: -- either X -> Y -> Z -> X, or <-> Y <-> Z <-> X. For the latter, uncomment the 6 lines below and comment out the next 3.
			% \draw[arr1] (Z) to[bend left=5] (Y);
			% \draw[arr1] (Y) to[bend left=5] (X);
			% \draw[arr1] (X) to[bend left=5] (Z);
			% \draw[fill=red!50!black] (210:0.22) circle (\vsize) ++(-130:.27) node[label=below:\tiny$X$]{};
			% \draw[fill=red!50!black] (-30:0.22) circle (\vsize) ++(-50:.27) node[label=below:\tiny$Y$]{};
			% \draw[fill=red!50!black] (90:0.22) circle (\vsize) ++(140:.31) node[label=above:\tiny$Z$]{};

			% grey filling for one covering.
			\draw[fill=white!70!black] (210:0.22) circle (\vsize) ++(-130:.27) node[label=below:\tiny$X$]{};
			\draw[fill=white!70!black] (-30:0.22) circle (\vsize) ++(-50:.27) node[label=below:\tiny$Z$]{};
			\draw[fill=white!70!black] (90:0.22) circle (\vsize) ++(40:.31) node[label=above:\tiny$Y$]{};

			\begin{scope}
				\clip (-30:0.22) circle (\vsize);
				\clip (210:0.22) circle (\vsize);
				% \fill[white!70!black] (-1,-1) rectangle (3,3);
				\clip (90:0.22) circle (\vsize);
				\fill[green!50!black] (-1,-1) rectangle (3,3);
			\end{scope}
			\begin{scope}
				\draw[] (-30:0.22) circle (\vsize);
				\draw[] (210:0.22) circle (\vsize);
				\draw[] (90:0.22) circle (\vsize);
			\end{scope}
	%		\useasboundingbox (current bounding box);
			\node at (-0.7, 0.7){\slshape\color{subfiglabelcolor}(\thesubfigure)};
		\end{tikzpicture}
	\hspace{3pt}
	\hspace{\spacerlength}%\vrule\hspace{\spacerlength}
		%% EXAMPLE: X -> Y <- Z
		\refstepcounter{subfigure}\label{subfig:XZtoY}
		\begin{tikzpicture}[center base]
			% \node[dpad0] (1) at (-0.5,2.3){$1$};
			\node[dpad0] (X) at (-0.45,1.9){$X$};
			\node[dpad0] (Z) at (0.3,1.25){$Z$};
			\node[dpad0] (Y) at (0.4,2.15){$Y$};
			% \draw[arr0] (1) to (X);
			\draw[arr0] (X) to[] (Z);
			\draw[arr1] (Y) to[] (Z);
			\path[fill=green!50!black] (210:0.22) circle (\vsize) ++(-130:.25) node[label=below:\tiny$X$]{};
			\path[fill=red!50!black] (-30:0.22) circle (\vsize) ++(-50:.25) node[label=below:\tiny$Z$]{};
			\path[fill=green!50!black] (90:0.22) circle (\vsize) ++(40:.29) node[label=above:\tiny$Y$]{};
			\begin{scope}
				\clip (-30:0.22) circle (\vsize);
				\clip (90:0.22) circle (\vsize);
				\fill[white!70!black] (-1,-1) rectangle (3,3);
			\end{scope}
			\begin{scope}
				\clip (-30:0.22) circle (\vsize);
				\clip (210:0.22) circle (\vsize);
				\fill[white!70!black] (-1,-1) rectangle (3,3);

				\clip (90:0.22) circle (\vsize);
				\fill[green!50!black] (-1,-1) rectangle (3,3);
				% \draw[ultra thick,white] (210:0.2) circle (\vsize);
				% \draw[ultra thick,white] (90:0.2) circle (\vsize);
				% \draw[ultra thick,white] (-30:0.2) circle (\vsize);
				% \draw[ultra thick,white] (210:0.2) circle (\vsize);
				% \draw[ultra thick,white] (90:0.2) circle (\vsize);
			\end{scope}
			\draw[] (-30:0.22) circle (\vsize);
			\draw[] (210:0.22) circle (\vsize);
			\draw[] (90:0.22) circle (\vsize);
	%		\useasboundingbox (current bounding box);
			\node at (-0.7, 0.7){\slshape\color{subfiglabelcolor}(\thesubfigure)};
		\end{tikzpicture}~
		\hspace{\spacerlength}%\vrule\hspace{\spacerlength}
			%% EXAMPLE: X <-> Y <-> Z
			\refstepcounter{subfigure}\label{subfig:XYZ-bichain}
			\begin{tikzpicture}[center base]
				% \node[dpad0] (1) at (0.1,2.4){$1$};
				\node[dpad0] (X) at (-0.5,1.3){$X$};
				\node[dpad0] (Y) at (-0.25,2.3){$Y$};
				\node[dpad0] (Z) at (0.5,1.5){$Z$};
				% \draw[arr1] (1) to (X);
				% \draw[arr1] (1) to (Y);
				\draw[arr1] (X) to[bend right=15] (Y);
				\draw[arr1] (Y) to[bend right=15] (X);
				\draw[arr1] (Y) to[bend right=15] (Z);
				\draw[arr1] (Z) to[bend right=15] (Y);
				\path[fill=white!70!black] (210:0.22) circle (\vsize) ++(-130:.25) node[label=below:\tiny$X$]{};
				\path[fill=white!70!black] (-30:0.22) circle (\vsize) ++(-50:.25) node[label=below:\tiny$Z$]{};
				\path[fill=red!50!black] (90:0.22) circle (\vsize) ++(40:.29) node[label=above:\tiny$Y$]{};
				\begin{scope}
					\clip (-30:0.22) circle (\vsize);
					\clip (90:0.22) circle (\vsize);
					\fill[white!70!black] (-1,-1) rectangle (3,3);
				\end{scope}
				\begin{scope}
					\clip (-30:0.22) circle (\vsize);
					\clip (210:0.22) circle (\vsize);
					\fill[red!50!black] (-1,-1) rectangle (3,3);
				\end{scope}
				\begin{scope}
					\clip (90:0.22) circle (\vsize);
					\clip (210:0.22) circle (\vsize);
					\fill[white!70!black] (-1,-1) rectangle (3,3);

					\clip (-30:0.22) circle (\vsize);
					\fill[green!50!black] (-1,-1) rectangle (3,3);
					% \draw[ultra thick,white] (210:0.2) circle (\vsize);
					% \draw[ultra thick,white] (90:0.2) circle (\vsize);
					% \draw[ultra thick,white] (-30:0.2) circle (\vsize);
					% \draw[ultra thick,white] (210:0.2) circle (\vsize);
					% \draw[ultra thick,white] (90:0.2) circle (\vsize);
				\end{scope}
				\draw[] (-30:0.22) circle (\vsize);
				\draw[] (210:0.22) circle (\vsize);
				\draw[] (90:0.22) circle (\vsize);
	%			\useasboundingbox (current bounding box);
				\node at (-0.7, 0.7){\slshape\color{subfiglabelcolor}(\thesubfigure)};
			\end{tikzpicture}
        \refstepcounter{subfigure}\label{subfig:X-Y-Z-undir}
        \begin{tikzpicture}[center base]
            % \node[dpad0] (1) at (0.1,2.4){$1$};
            \node[dpad0] (X) at (-0.55,1.3){$X$};
            \node[dpad0] (Y) at (0,2.3){$Y$};
            \node[dpad0] (Z) at (0.55,1.3){$Z$};
            % \draw[arr1] (1) to (X);
            % \draw[arr1] (1) to (Y);
            \draw[arr1] (Y) to (X);
            \draw[arr1] (Y) to (Z);
            \mergearr[arr1] XZY
            \path[fill=white!70!black] (210:0.22) circle (\vsize) ++(-130:.25) node[label=below:\tiny$X$]{};
            \path[fill=white!70!black] (-30:0.22) circle (\vsize) ++(-50:.25) node[label=below:\tiny$Z$]{};
            \path[fill=white!70!black] (90:0.22) circle (\vsize) ++(40:.29) node[label=above:\tiny$Y$]{};
            \begin{scope}
                \clip (-30:0.22) circle (\vsize);
                \clip (90:0.22) circle (\vsize);
                \fill[white!70!black] (-1,-1) rectangle (3,3);
            \end{scope}
            \begin{scope}
                \clip (-30:0.22) circle (\vsize);
                \clip (210:0.22) circle (\vsize);
                \fill[red!50!black] (-1,-1) rectangle (3,3);
            \end{scope}
            \begin{scope}
                \clip (90:0.22) circle (\vsize);
                \clip (210:0.22) circle (\vsize);
                \fill[green!50!black] (-1,-1) rectangle (3,3);
            \end{scope}
            \begin{scope}
                \clip (-30:0.22) circle (\vsize);
                \clip (90:0.22) circle (\vsize);
                \fill[green!50!black] (-1,-1) rectangle (3,3);
            \end{scope}
            \draw[] (-30:0.22) circle (\vsize);
            \draw[] (210:0.22) circle (\vsize);
            \draw[] (90:0.22) circle (\vsize);
%			\useasboundingbox (current bounding box);
            \node at (-0.7, 0.7){\slshape\color{subfiglabelcolor}(\thesubfigure)};
        \end{tikzpicture}
			% }
	% }
	\addtocounter{figure}{-1} %undo the thing I did to make subfigs work
	% \captionof{figure}{\label{fig:sdef-example-panel}
	\caption[Illustrations of the information deficiency ($\SDef_{\!\Ar})$ 
		for various hypergraphs $\Ar$]
	{
		% \itshape
        % Illustrations of  example graph information functions
        % Illustrations of $\SDef
        Illustrations of the structural deficiency $\SDef_{\Ar}$ underneath
          % $\{ \SDef{G_i} \}$,
          drawn underneath their
		  associated hypergraphs $\{ G_i\}$. Each circle represents a
		  variable; an area in the intersection of circles $\{C_j\}$
		  but outside of circles $\{D_k\}$ corresponds to information
		  that is shared between all $C_j$'s, but not in any
		  $D_k$. Variation of a candidate distribution $\mu$ in a
		  green area makes its qualitative fit better (according to
		  $\SDef{}$), while variation in a red area makes its
		  qualitative fit worse; grey is neutral.
		  Only the boxed structures in blue,
		  whose $\SDef$ can be seen as measuring distance to a particular set of (conditional) independencies, are expressible as BNs.}
	\label{fig:sdef-example-panel}
\end{figure}

% In more complicated examples, where both penalties and rewards exist, we argue that the $G$-information still implicitly captures the qualitative structure. In \ref{subfig:XYZ-bichain}, $X$ and $Y$ determine one another, and $Z$ and $Y$ determine one another. It is clear that $X$ and $Z$ should be indpenedent given $Y$; it can also be argued that $Y$ should not have any randomness of its own (otherwise the draws from $X$ or $Z$ would likey not match one another) and that this structure suggests co-variation of all three variables.
% \end{example}
